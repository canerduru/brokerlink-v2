<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrokerLink - AgentConnect Style</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://placehold.co/192x192/1e40af/ffffff.png?text=BL">
    <style>
        /* Alpine.js x-cloak - Hide elements until Alpine loads */
        [x-cloak] {
            display: none !important;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
            /* gray-50 */
            margin: 0;
        }

        .app-layout {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid #e5e7eb;
            display: none;
            /* Hidden on mobile */
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 50;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            width: 100%;
            background: #f9fafb;
            padding-bottom: 80px;
            /* Space for bottom nav on mobile */
        }

        /* Desktop Adjustments */
        @media (min-width: 768px) {
            .sidebar {
                display: flex;
            }

            .main-content {
                margin-left: 280px;
                /* Sidebar width */
                padding-bottom: 0;
                padding: 2rem;
            }

            .mobile-nav {
                display: none !important;
            }

            .mobile-header {
                display: none !important;
            }
        }

        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .nav-item-active {
            color: #1e40af;
        }

        .nav-item-inactive {
            color: #9ca3af;
        }

        .glass-nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid #f3f4f6;
        }

        .shadow-soft {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        .card-shadow {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .fab-shadow {
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.4);
        }
    </style>
</head>

<body class="bg-gray-50" x-data="app()" x-init="init()">
    <div class="app-layout">

        <!-- AUTH MODAL (Blocks everything if not logged in) -->
        <template x-if="!user">
            <div class="fixed inset-0 z-50 bg-gray-50 flex items-center justify-center p-4">
                <div class="bg-white rounded-3xl shadow-xl w-full max-w-md p-8 border border-gray-100">
                    <div class="text-center mb-8">
                        <div
                            class="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-blue-200">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4">
                                </path>
                            </svg>
                        </div>
                        <h1 class="text-2xl font-bold text-gray-900">BrokerLink'e Hoşgeldiniz</h1>
                        <p class="text-gray-500 mt-2">Profesyonel Emlak Ağı</p>
                    </div>

                    <form @submit.prevent="handleAuth" class="space-y-4">
                        <div x-show="authMode === 'register'">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Ad Soyad</label>
                            <input type="text" x-model="authName"
                                class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:border-blue-500 transition-colors"
                                placeholder="Ahmet Yılmaz">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">E-posta</label>
                            <input type="email" x-model="authEmail" required
                                class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:border-blue-500 transition-colors"
                                placeholder="ornek@email.com">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Şifre</label>
                            <input type="password" x-model="authPassword" required
                                class="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 focus:outline-none focus:border-blue-500 transition-colors"
                                placeholder="••••••••">
                        </div>

                        <div x-show="authError" class="text-red-500 text-sm bg-red-50 p-3 rounded-lg"
                            x-text="authError"></div>

                        <button type="submit"
                            class="w-full bg-blue-600 text-white font-bold py-3.5 rounded-xl hover:bg-blue-700 transition-colors shadow-lg shadow-blue-200 flex items-center justify-center gap-2"
                            :disabled="authLoading">
                            <span x-show="authLoading"
                                class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></span>
                            <span x-text="authMode === 'login' ? 'Giriş Yap' : 'Kayıt Ol'"></span>
                        </button>
                    </form>

                    <div class="mt-6 text-center">
                        <p class="text-sm text-gray-500">
                            <span
                                x-text="authMode === 'login' ? 'Hesabınız yok mu?' : 'Zaten hesabınız var mı?'"></span>
                            <button @click="authMode = authMode === 'login' ? 'register' : 'login'"
                                class="text-blue-600 font-bold hover:underline ml-1">
                                <span x-text="authMode === 'login' ? 'Kayıt Ol' : 'Giriş Yap'"></span>
                            </button>
                        </p>
                    </div>
                </div>
            </div>
        </template>

        <!-- SIDEBAR (Desktop Only) -->
        <div class="sidebar">
            <div class="p-6 border-b border-gray-100">
                <h1 class="text-2xl font-bold text-blue-600 flex items-center gap-2">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4">
                        </path>
                    </svg>
                    BrokerLink
                </h1>
            </div>

            <nav class="flex-1 p-4 space-y-1 overflow-y-auto">
                <button @click="currentTab = 'dashboard'"
                    class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-colors"
                    :class="currentTab === 'dashboard' ? 'bg-blue-50 text-blue-600' : 'text-gray-600 hover:bg-gray-50'">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" />
                    </svg>
                    Dashboard
                </button>
                <button @click="currentTab = 'portfolios'"
                    class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-colors"
                    :class="currentTab === 'portfolios' ? 'bg-blue-50 text-blue-600' : 'text-gray-600 hover:bg-gray-50'">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                    </svg>
                    Portföyler
                </button>
                <button @click="currentTab = 'demands'"
                    class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-colors"
                    :class="currentTab === 'demands' ? 'bg-blue-50 text-blue-600' : 'text-gray-600 hover:bg-gray-50'">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    Talepler
                </button>
                <button @click="currentTab = 'matches'"
                    class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-colors"
                    :class="currentTab === 'matches' ? 'bg-blue-50 text-blue-600' : 'text-gray-600 hover:bg-gray-50'">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                    </svg>
                    Eşleşmeler
                </button>
                <button @click="currentTab = 'messages'"
                    class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-colors"
                    :class="currentTab === 'messages' ? 'bg-blue-50 text-blue-600' : 'text-gray-600 hover:bg-gray-50'">
                    <div class="relative">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z">
                            </path>
                        </svg>
                        <div class="absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white"
                            x-show="conversations.reduce((acc, c) => acc + c.unread, 0) > 0"></div>
                    </div>
                    Mesajlar
                </button>
                <button @click="currentTab = 'network'"
                    class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-colors"
                    :class="currentTab === 'network' ? 'bg-blue-50 text-blue-600' : 'text-gray-600 hover:bg-gray-50'">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" />
                    </svg>
                    Ağ
                </button>
            </nav>

            <div class="p-4 border-t border-gray-100">
                <div class="flex items-center gap-3 p-2 rounded-xl hover:bg-gray-50 cursor-pointer mb-2">
                    <div class="w-10 h-10 rounded-full bg-gray-200 overflow-hidden">
                        <img src="https://i.pravatar.cc/150?img=11" alt="Profile" class="w-full h-full object-cover">
                    </div>
                    <div>
                        <p class="text-sm font-bold text-gray-900">Ahmet Yılmaz</p>
                        <p class="text-xs text-gray-500">Broker</p>
                    </div>
                </div>
                <button @click="seedData()"
                    class="w-full py-2 bg-blue-50 text-blue-600 rounded-lg text-xs font-bold hover:bg-blue-100 transition-colors flex items-center justify-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
                        </path>
                    </svg>
                    Verileri Yükle
                </button>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">

            <!-- Messages View -->
            <div x-show="currentTab === 'messages'" class="h-[calc(100vh-2rem)] flex gap-6 p-5" x-cloak>
                <!-- Conversation List -->
                <div
                    class="w-1/3 bg-white rounded-3xl shadow-sm border border-gray-100 flex flex-col overflow-hidden h-full">
                    <div class="p-5 border-b border-gray-50">
                        <h2 class="text-xl font-bold text-gray-900">Mesajlar</h2>
                        <div class="mt-4 relative">
                            <input type="text" placeholder="Arama..."
                                class="w-full bg-gray-50 border border-gray-100 rounded-xl py-2.5 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-200 transition-all">
                            <svg class="w-4 h-4 text-gray-400 absolute left-3.5 top-3.5" fill="none"
                                stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="flex-1 overflow-y-auto">
                        <template x-for="conv in conversations" :key="conv.id">
                            <div @click="activeConversation = conv"
                                class="p-4 border-b border-gray-50 cursor-pointer hover:bg-gray-50 transition-colors flex gap-3"
                                :class="activeConversation && activeConversation.id === conv.id ? 'bg-blue-50/50' : ''">
                                <div class="relative">
                                    <img :src="conv.userImage" class="w-12 h-12 rounded-full object-cover">
                                    <div
                                        class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white">
                                    </div>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex justify-between items-start mb-1">
                                        <h3 class="font-bold text-gray-900 text-sm truncate" x-text="conv.userName">
                                        </h3>
                                        <span class="text-xs text-gray-400 whitespace-nowrap" x-text="conv.time"></span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <p class="text-sm text-gray-500 truncate" x-text="conv.lastMessage"
                                            :class="conv.unread > 0 ? 'font-semibold text-gray-800' : ''"></p>
                                        <div x-show="conv.unread > 0"
                                            class="bg-blue-600 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full min-w-[18px] text-center"
                                            x-text="conv.unread"></div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Chat Area -->
                <div
                    class="flex-1 bg-white rounded-3xl shadow-sm border border-gray-100 flex flex-col overflow-hidden h-full">
                    <template x-if="activeConversation">
                        <div class="flex flex-col h-full">
                            <!-- Chat Header -->
                            <div class="p-4 border-b border-gray-50 flex justify-between items-center bg-white z-10">
                                <div class="flex items-center gap-3">
                                    <img :src="activeConversation.userImage"
                                        class="w-10 h-10 rounded-full object-cover">
                                    <div>
                                        <h3 class="font-bold text-gray-900" x-text="activeConversation.userName"></h3>
                                        <p class="text-xs text-green-500 font-medium flex items-center gap-1">
                                            <span class="w-1.5 h-1.5 rounded-full bg-green-500"></span>
                                            Çevrimiçi
                                        </p>
                                    </div>
                                </div>
                                <div class="flex gap-2">
                                    <button
                                        class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z">
                                            </path>
                                        </svg>
                                    </button>
                                    <button
                                        class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z">
                                            </path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Messages -->
                            <div class="flex-1 overflow-y-auto p-5 space-y-4 bg-gray-50/50">
                                <template x-for="msg in activeConversation.messages" :key="msg.id">
                                    <div class="flex" :class="msg.sender === 'me' ? 'justify-end' : 'justify-start'">
                                        <div class="max-w-[70%] rounded-2xl px-4 py-2.5 shadow-sm"
                                            :class="msg.sender === 'me' ? 'bg-blue-600 text-white rounded-tr-none' : 'bg-white text-gray-800 border border-gray-100 rounded-tl-none'">
                                            <p class="text-sm leading-relaxed" x-text="msg.text"></p>
                                            <p class="text-[10px] mt-1 opacity-70 text-right" x-text="msg.time"></p>
                                        </div>
                                    </div>
                                </template>
                            </div>

                            <!-- Input -->
                            <div class="p-4 bg-white border-t border-gray-50">
                                <div class="flex gap-2">
                                    <button
                                        class="p-2.5 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-xl transition-colors">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13">
                                            </path>
                                        </svg>
                                    </button>
                                    <input type="text" placeholder="Bir mesaj yazın..."
                                        class="flex-1 bg-gray-50 border border-gray-100 rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-200 transition-all">
                                    <button
                                        class="p-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-200 transition-all">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </template>
                    <template x-if="!activeConversation">
                        <div class="flex-1 flex flex-col items-center justify-center text-gray-400 p-10 text-center">
                            <div class="w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mb-4">
                                <svg class="w-10 h-10 text-gray-300" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z">
                                    </path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-gray-900 mb-2">Mesajlarınız</h3>
                            <p class="text-sm max-w-xs">Sol taraftan bir sohbet seçerek mesajlaşmaya başlayabilirsiniz.
                            </p>
                        </div>
                    </template>
                </div>
            </div>

            <!-- MOBILE HEADER -->
            <div class="mobile-header sticky top-0 z-30 bg-white px-5 py-4 border-b border-gray-100 md:hidden">
                <div class="flex justify-between items-center">
                    <h1 class="text-2xl font-bold text-blue-600">BrokerLink</h1>
                    <button
                        class="w-10 h-10 bg-gray-50 rounded-xl flex items-center justify-center text-gray-600 relative">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                            </path>
                        </svg>
                        <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>
                    </button>
                </div>
            </div>

            <!-- DASHBOARD VIEW -->
            <div x-show="currentTab === 'dashboard'" class="pb-24 w-full" x-cloak>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-5">
                    <!-- Left Column: Stats & Matches -->
                    <div class="md:col-span-2 space-y-6">
                        <!-- Stats Cards -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <!-- Aktif Portföy -->
                            <div @click="currentTab = 'portfolios'"
                                class="bg-white rounded-2xl p-4 border border-gray-100 shadow-sm hover:shadow-md transition-shadow cursor-pointer group">
                                <div class="flex items-center gap-2 mb-1">
                                    <div
                                        class="w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center group-hover:bg-blue-100 transition-colors">
                                        <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                        </svg>
                                    </div>
                                    <span
                                        class="text-xs text-gray-500 font-medium group-hover:text-blue-600 transition-colors">Aktif
                                        Portföy</span>
                                </div>
                                <div class="text-3xl font-bold text-gray-900" x-text="portfolios.length">4</div>
                            </div>
                            <!-- Aktif Talep -->
                            <div @click="currentTab = 'demands'"
                                class="bg-white rounded-2xl p-4 border border-gray-100 shadow-sm hover:shadow-md transition-shadow cursor-pointer group">
                                <div class="flex items-center gap-2 mb-1">
                                    <div
                                        class="w-8 h-8 rounded-lg bg-green-50 flex items-center justify-center group-hover:bg-green-100 transition-colors">
                                        <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                        </svg>
                                    </div>
                                    <span
                                        class="text-xs text-gray-500 font-medium group-hover:text-green-600 transition-colors">Aktif
                                        Talep</span>
                                </div>
                                <div class="text-3xl font-bold text-gray-900" x-text="demands.length">2</div>
                            </div>
                            <!-- Toplam Eşleşme -->
                            <div @click="currentTab = 'matches'"
                                class="bg-white rounded-2xl p-4 border border-gray-100 shadow-sm hover:shadow-md transition-shadow cursor-pointer group">
                                <div class="flex items-center gap-2 mb-1">
                                    <div
                                        class="w-8 h-8 rounded-lg bg-yellow-50 flex items-center justify-center group-hover:bg-yellow-100 transition-colors">
                                        <svg class="w-4 h-4 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
                                            <path
                                                d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                        </svg>
                                    </div>
                                    <span
                                        class="text-xs text-gray-500 font-medium group-hover:text-yellow-600 transition-colors">Toplam
                                        Eşleşme</span>
                                </div>
                                <div class="text-3xl font-bold text-gray-900">3</div>
                            </div>
                            <!-- Ortalama Skor -->
                            <div
                                class="bg-white rounded-2xl p-4 border border-gray-100 shadow-sm hover:shadow-md transition-shadow cursor-pointer group">
                                <div class="flex items-center gap-2 mb-1">
                                    <div
                                        class="w-8 h-8 rounded-lg bg-purple-50 flex items-center justify-center group-hover:bg-purple-100 transition-colors">
                                        <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                                            </path>
                                        </svg>
                                    </div>
                                    <span
                                        class="text-xs text-gray-500 font-medium group-hover:text-purple-600 transition-colors">Ortalama
                                        Skor</span>
                                </div>
                                <div class="text-3xl font-bold text-gray-900">97%</div>
                            </div>
                        </div>

                        <!-- Son Eşleşmeler -->
                        <div>
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-bold text-gray-900">Son Eşleşmeler</h3>
                                <button class="text-sm text-blue-600 font-semibold">Tümünü Gör</button>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <template x-for="match in matches.slice(0, 4)" :key="match.id">
                                    <div class="bg-white rounded-2xl overflow-hidden border border-gray-100 shadow-sm hover:shadow-md transition-shadow cursor-pointer"
                                        @click="openMatchDetail()">
                                        <div class="h-28 bg-gray-100 relative">
                                            <div class="absolute top-2 left-2 bg-emerald-500 text-white text-xs font-bold px-2 py-1 rounded-lg"
                                                x-text="match.score + '% Eşleşme'"></div>
                                        </div>
                                        <div class="p-3">
                                            <h3 class="font-bold text-gray-900 text-sm mb-1" x-text="match.name"></h3>
                                            <p class="text-blue-600 font-bold text-xs mb-1" x-text="match.price"></p>
                                            <p class="text-gray-500 text-xs mb-2 flex items-center gap-1">
                                                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fill-rule="evenodd"
                                                        d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
                                                        clip-rule="evenodd" />
                                                </svg>
                                                <span x-text="match.location"></span>
                                            </p>
                                            <div class="flex items-center gap-2 text-gray-400 text-xs mb-3">
                                                <span x-text="match.specs"></span>
                                            </div>
                                            <div class="flex gap-2">
                                                <button @click.stop="rejectMatch(match.id)"
                                                    class="flex-1 py-1.5 border border-red-200 text-red-600 rounded-lg text-xs font-medium hover:bg-red-50">Reddet</button>
                                                <button @click.stop="approveMatch(match.id)"
                                                    class="flex-1 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-medium hover:bg-blue-700">Onayla</button>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Right Column: Network Activities -->
                <div class="md:col-span-1 space-y-4">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-bold text-gray-900">Ağ Hareketleri</h3>
                        <button class="text-sm text-blue-600 font-semibold">Tümü</button>
                    </div>
                    <div class="space-y-3">
                        <template x-for="activity in networkActivities" :key="activity.id">
                            <div class="bg-white p-4 rounded-2xl shadow-soft border border-gray-50 flex gap-4">
                                <div class="w-12 h-12 rounded-full bg-gray-200 overflow-hidden flex-shrink-0">
                                    <img :src="activity.avatar" class="w-full h-full object-cover">
                                </div>
                                <div class="flex-1">
                                    <div class="flex justify-between items-start">
                                        <h4 class="font-bold text-gray-900 text-sm" x-text="activity.user"></h4>
                                        <span class="text-gray-400 text-xs" x-text="activity.time"></span>
                                    </div>
                                    <p class="text-gray-600 text-sm mt-1" x-text="activity.action"></p>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>


        <!-- MATCHES VIEW -->
        <div x-show="currentTab === 'matches'" class="pb-24 w-full" x-cloak>
            <div class="px-5 py-4 border-b border-gray-100">
                <h2 class="text-xl font-bold text-gray-900">Eşleşmeler</h2>
            </div>

            <!-- Tabs -->
            <div class="px-5 pt-4">
                <div
                    class="bg-purple-50 rounded-2xl p-4 flex items-center justify-between border border-purple-100 mb-4">
                    <div class="flex items-center gap-3">
                        <div
                            class="w-10 h-10 rounded-xl bg-white flex items-center justify-center shadow-sm text-purple-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                                </path>
                            </svg>
                        </div>
                        <div>
                            <div class="text-xs text-purple-600 font-bold uppercase tracking-wide">Ortalama Skor
                            </div>
                            <div class="text-2xl font-bold text-gray-900">97%</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-xs text-gray-500">Son 30 gün</div>
                        <div class="text-xs text-emerald-600 font-bold flex items-center justify-end gap-1">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                            </svg>
                            +2.4%
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="px-5 pt-4 mb-4">
                <div class="flex gap-3 overflow-x-auto hide-scrollbar">
                    <button @click="currentMatchFilter = 'all'"
                        class="px-4 py-2 rounded-full text-sm font-semibold flex items-center gap-1.5 transition-colors"
                        :class="currentMatchFilter === 'all' ? 'bg-blue-600 text-white' : 'bg-gray-50 text-gray-600 hover:bg-gray-100'">
                        Tümü <span class="px-1.5 py-0.5 rounded-full text-xs"
                            :class="currentMatchFilter === 'all' ? 'bg-white/20' : 'bg-gray-200'">6</span>
                    </button>
                    <button @click="currentMatchFilter = 'top'"
                        class="px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-1.5 transition-colors"
                        :class="currentMatchFilter === 'top' ? 'bg-blue-600 text-white' : 'bg-gray-50 text-gray-600 hover:bg-gray-100'">
                        Top <span class="px-1.5 py-0.5 rounded-full text-xs"
                            :class="currentMatchFilter === 'top' ? 'bg-white/20' : 'bg-gray-200'">3</span>
                    </button>
                    <button @click="currentMatchFilter = 'favorites'"
                        class="px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-1.5 transition-colors"
                        :class="currentMatchFilter === 'favorites' ? 'bg-blue-600 text-white' : 'bg-gray-50 text-gray-600 hover:bg-gray-100'">
                        Favoriler <span class="px-1.5 py-0.5 rounded-full text-xs"
                            :class="currentMatchFilter === 'favorites' ? 'bg-white/20' : 'bg-gray-200'"
                            x-text="matches.filter(m => m.isFavorite).length"></span>
                    </button>
                </div>
            </div>

            <!-- Matches List -->
            <div class="px-5 space-y-3">
                <template x-for="match in matches.filter(m => {
                        if (currentMatchFilter === 'favorites') return m.isFavorite;
                        if (currentMatchFilter === 'top') return m.score >= 90;
                        return true;
                    }).sort((a, b) => b.score - a.score)" :key="match.id">
                    <div class="bg-white rounded-2xl border border-gray-100 overflow-hidden">
                        <!-- Header -->
                        <div class="p-4 flex justify-between items-start border-b border-gray-50">
                            <div>
                                <h3 class="font-bold text-gray-900 mb-1" x-text="match.title + ' ↔ ' + match.name">
                                </h3>
                                <p class="text-emerald-600 text-xs font-medium" x-text="match.score + '% Eşleşme'">
                                </p>
                            </div>
                            <div class="flex items-center gap-2">
                                <button @click="toggleFavorite(match.id)"
                                    class="p-1.5 rounded-full hover:bg-gray-50 transition-colors"
                                    :class="match.isFavorite ? 'text-red-500' : 'text-gray-300 hover:text-red-400'">
                                    <svg class="w-6 h-6" :fill="match.isFavorite ? 'currentColor' : 'none'"
                                        stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                                    </svg>
                                </button>
                                <div class="bg-emerald-500 text-white text-xs font-bold px-2.5 py-1 rounded-lg"
                                    x-text="match.score + '%'"></div>
                            </div>
                        </div>

                        <!-- Comparison -->
                        <div class="p-4 bg-gray-50">
                            <div class="flex gap-3 items-center mb-3">
                                <!-- Property -->
                                <div class="flex-1 bg-white rounded-xl p-3 border border-gray-100">
                                    <div class="w-full h-20 bg-gray-200 rounded-lg mb-2 overflow-hidden">
                                        <img src="https://images.unsplash.com/photo-1600596542815-2495db9dc2c3?auto=format&fit=crop&w=800&q=80"
                                            class="w-full h-full object-cover">
                                    </div>
                                    <h4 class="font-bold text-gray-900 text-sm mb-1" x-text="match.title || 'Portföy'">
                                    </h4>
                                    <p class="text-blue-600 font-bold text-sm mb-1" x-text="match.price"></p>
                                    <p class="text-gray-500 text-xs" x-text="match.location"></p>
                                    <p class="text-gray-400 text-xs" x-text="match.specs"></p>
                                </div>

                                <!-- Arrow -->
                                <div class="text-blue-400">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                    </svg>
                                </div>

                                <!-- Client -->
                                <div class="flex-1 bg-white rounded-xl p-3 border border-gray-100">
                                    <div class="w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold mb-2"
                                        x-text="match.name.charAt(0)"></div>
                                    <h4 class="font-bold text-gray-900 text-sm mb-1" x-text="match.name"></h4>
                                    <p class="text-emerald-600 font-semibold text-sm mb-1">Bütçe Uygun</p>
                                    <p class="text-gray-500 text-xs" x-text="match.location"></p>
                                    <p class="text-gray-400 text-xs" x-text="match.specs"></p>
                                </div>
                            </div>

                            <!-- Criteria -->
                            <div class="flex flex-wrap gap-2 mb-3">
                                <span
                                    class="px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium flex items-center gap-1">
                                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd"
                                            d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                            clip-rule="evenodd" />
                                    </svg>
                                    Konum
                                </span>
                                <span
                                    class="px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium flex items-center gap-1">
                                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd"
                                            d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                            clip-rule="evenodd" />
                                    </svg>
                                    Bütçe
                                </span>
                            </div>

                            <!-- Actions -->
                            <div class="flex gap-2">
                                <button @click="rejectMatch(match.id)"
                                    class="flex-1 py-2.5 border-2 border-red-200 text-red-600 rounded-xl font-semibold text-sm hover:bg-red-50 flex items-center justify-center gap-1 transition-colors">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                    Reddet
                                </button>
                                <button @click="approveMatch(match.id)"
                                    class="flex-1 py-2.5 bg-emerald-500 text-white rounded-xl font-semibold text-sm hover:bg-emerald-600 flex items-center justify-center gap-1 transition-colors">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M5 13l4 4L19 7" />
                                    </svg>
                                    Onayla
                                </button>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
        </div>
        <!-- NETWORK/AĞ VIEW -->
        <div x-show="currentTab === 'network'" class="pb-24 w-full" x-cloak>
            <!-- Header -->
            <div class="px-5 py-4 border-b border-gray-100">
                <h2 class="text-xl font-bold text-gray-900">Ağ</h2>
                <p class="text-sm text-gray-500 mt-1">Broker ağınızı yönetin</p>
            </div>

            <!-- Search & Filter -->
            <div class="px-5 py-4 border-b border-gray-50">
                <div class="relative">
                    <input type="text" placeholder="İsim veya şehir ara..."
                        class="w-full bg-white border border-gray-200 rounded-xl py-3 pl-10 pr-4 text-sm focus:outline-none focus:border-blue-500">
                    <svg class="w-5 h-5 text-gray-400 absolute left-3 top-3" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
            </div>

            <!-- Network List -->
            <div class="px-5 py-4 grid grid-cols-1 md:grid-cols-2 gap-3">
                <template x-for="broker in network" :key="broker.id">
                    <div
                        class="bg-white rounded-2xl p-4 border border-gray-100 shadow-sm hover:shadow-md transition-shadow">
                        <div class="flex items-center gap-3">
                            <div class="w-14 h-14 rounded-full flex items-center justify-center font-bold text-lg flex-shrink-0"
                                :class="broker.color" x-text="broker.initials"></div>
                            <div class="flex-1 min-w-0">
                                <h3 class="font-bold text-gray-900" x-text="broker.name"></h3>
                                <p class="text-sm text-gray-500" x-text="broker.location"></p>
                                <div class="flex gap-2 mt-1">
                                    <span class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full"
                                        x-text="broker.listings + ' İlan'"></span>
                                    <span class="text-xs px-2 py-0.5 rounded-full"
                                        :class="broker.status === 'Aktif' ? 'bg-green-50 text-green-700' : (broker.status === 'Meşgul' ? 'bg-yellow-50 text-yellow-700' : 'bg-gray-100 text-gray-600')"
                                        x-text="broker.status"></span>
                                </div>
                            </div>
                            <button @click="sendMessage(broker.name)"
                                class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700">Mesaj</button>
                        </div>
                    </div>
                </template>
            </div>
        </div>
        <!-- PORTFOLIOS/PORTFÖYLER VIEW -->
        <div x-show="currentTab === 'portfolios'" class="pb-24 w-full" x-cloak>
            <!-- Header -->
            <div class="px-5 py-4 border-b border-gray-100">
                <div class="flex justify-between items-center">
                    <div>
                        <h2 class="text-xl font-bold text-gray-900">Portföylerim</h2>
                        <p class="text-sm text-gray-500 mt-1">Tüm gayrimenkullerinizi yönetin</p>
                    </div>
                    <button @click="showAddModal = true"
                        class="hidden md:flex items-center gap-2 bg-blue-600 text-white px-4 py-2.5 rounded-lg hover:bg-blue-700 transition-colors shadow-sm">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4">
                            </path>
                        </svg>
                        <span class="font-medium">Yeni Ekle</span>
                    </button>
                </div>
            </div>

            <!-- Summary Bar -->
            <div class="px-5 py-4 bg-white border-b border-gray-50">
                <div class="flex gap-4 text-sm">
                    <div class="flex items-center gap-2">
                        <span class="text-gray-500">Toplam:</span>
                        <span class="font-bold text-blue-600" x-text="portfolios.length">0</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-gray-500">Satılık:</span>
                        <span class="font-bold text-emerald-600"
                            x-text="portfolios.filter(p => p.type === 'Satılık').length">0</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-gray-500">Kiralık:</span>
                        <span class="font-bold text-orange-600"
                            x-text="portfolios.filter(p => p.type === 'Kiralık').length">0</span>
                    </div>
                </div>
            </div>

            <!-- Filter Buttons & View Controls -->
            <div class="px-5 py-3 border-b border-gray-50">
                <!-- Satılık/Kiralık Toggle -->
                <div class="flex gap-2 mb-3">
                    <button @click="currentPortfolioListingType = 'satilik'"
                        class="px-4 py-2 rounded-xl text-sm font-semibold transition-all"
                        :class="currentPortfolioListingType === 'satilik' ? 'bg-emerald-500 text-white shadow-lg shadow-emerald-200' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'">
                        <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
                            <path
                                d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                        </svg>
                        Satılık
                    </button>
                    <button @click="currentPortfolioListingType = 'kiralik'"
                        class="px-4 py-2 rounded-xl text-sm font-semibold transition-all"
                        :class="currentPortfolioListingType === 'kiralik' ? 'bg-orange-500 text-white shadow-lg shadow-orange-200' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'">
                        <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                        Kiralık
                    </button>
                </div>

                <!-- Category Filter Buttons -->
                <div class="flex gap-2 mb-3 overflow-x-auto hide-scrollbar">
                    <button @click="currentPortfolioCategory = 'all'"
                        class="px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap"
                        :class="currentPortfolioCategory === 'all' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'">
                        Tümü
                    </button>
                    <button @click="currentPortfolioCategory = 'Villa'"
                        class="px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap"
                        :class="currentPortfolioCategory === 'Villa' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'">
                        Villa
                    </button>
                    <button @click="currentPortfolioCategory = 'Daire'"
                        class="px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap"
                        :class="currentPortfolioCategory === 'Daire' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'">
                        Daire
                    </button>
                    <button @click="currentPortfolioCategory = 'Arsa'"
                        class="px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap"
                        :class="currentPortfolioCategory === 'Arsa' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'">
                        Arsa
                    </button>
                    <button @click="currentPortfolioCategory = 'İşyeri'"
                        class="px-3 py-1.5 rounded-lg text-xs font-semibold transition-all whitespace-nowrap"
                        :class="currentPortfolioCategory === 'İşyeri' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'">
                        İşyeri
                    </button>
                </div>

                <!-- View Controls -->
                <div class="flex gap-2 items-center justify-between">
                    <div class="flex gap-2">
                        <button class="px-3 py-1.5 bg-blue-600 text-white rounded-lg text-sm font-medium">
                            <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
                                <path
                                    d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z" />
                            </svg>
                            Liste
                        </button>
                    </div>
                    <div class="flex gap-2 items-center">
                        <button class="text-gray-500 p-2 hover:bg-gray-100 rounded-lg">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
                            </svg>
                        </button>
                        <!-- Sort Dropdown -->
                        <select x-model="portfolioSortOrder"
                            class="text-sm border border-gray-200 rounded-lg px-3 py-1.5 text-gray-600 focus:outline-none focus:border-blue-500">
                            <option>Tarih</option>
                            <option>Fiyat (Düşük)</option>
                            <option>Fiyat (Yüksek)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Properties Grid - 3 columns -->
            <div class="px-5 py-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                <template x-for="portfolio in filteredMyPortfolios" :key="portfolio.id">
                    <div
                        class="bg-white rounded-2xl border border-gray-100 overflow-hidden shadow-sm hover:shadow-md transition-shadow">
                        <!-- Image -->
                        <div class="relative">
                            <div class="h-32 bg-gray-200 overflow-hidden">
                                <img :src="portfolio.image || 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=800&q=80'"
                                    class="w-full h-full object-cover" alt="">
                            </div>
                            <!-- Type Badge -->
                            <div class="absolute top-2 left-2 text-white text-xs font-bold px-2 py-1 rounded-lg"
                                :class="portfolio.type === 'Kiralık' ? 'bg-orange-500' : 'bg-emerald-500'"
                                x-text="portfolio.type">
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="p-3">
                            <!-- Price -->
                            <div class="font-bold text-base mb-1"
                                :class="portfolio.type === 'Kiralık' ? 'text-orange-600' : 'text-emerald-600'"
                                x-text="formatPrice(portfolio.price)"></div>

                            <!-- Title -->
                            <h3 class="font-bold text-gray-900 text-sm mb-1" x-text="portfolio.title"></h3>

                            <!-- Category Badge -->
                            <div class="mb-2">
                                <span class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full font-medium"
                                    x-text="portfolio.category"></span>
                            </div>

                            <!-- Location -->
                            <p class="text-gray-500 text-xs mb-2 flex items-center gap-1">
                                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
                                        clip-rule="evenodd" />
                                </svg>
                                <span x-text="portfolio.location || portfolio.district"></span>
                            </p>

                            <!-- Specs -->
                            <div class="flex items-center gap-2 text-gray-400 text-xs mb-2">
                                <span class="flex items-center gap-1">
                                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                        <path
                                            d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                                    </svg>
                                    <span x-text="portfolio.rooms || '3+1'"></span>
                                </span>
                                <span>•</span>
                                <span class="flex items-center gap-1">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
                                    </svg>
                                    <span x-text="portfolio.area || '140m²'"></span>
                                </span>
                                <span>•</span>
                                <span class="flex items-center gap-1">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    <span x-text="portfolio.age || '5y'"></span>
                                </span>
                            </div>

                            <!-- Features -->
                            <div class="flex flex-wrap gap-1 mb-2"
                                x-show="portfolio.features && portfolio.features.length > 0">
                                <template x-for="feature in (portfolio.features || []).slice(0, 2)" :key="feature">
                                    <span class="text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full"
                                        x-text="feature"></span>
                                </template>
                            </div>

                            <!-- Actions -->
                            <div class="flex gap-2">
                                <button @click="editPortfolio(portfolio.id)"
                                    class="flex-1 py-1.5 border border-gray-200 rounded-lg text-xs font-medium text-gray-600 hover:bg-gray-50 transition-colors">
                                    <svg class="w-3 h-3 inline mr-1" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                    </svg>
                                    Düzenle
                                </button>
                                <button @click="deletePortfolio(portfolio.id)"
                                    class="py-1.5 px-2 border border-red-200 text-red-600 rounded-lg hover:bg-red-50 transition-colors">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </template>

                <!-- Empty State -->
                <template x-if="filteredMyPortfolios.length === 0">
                    <div class="col-span-3 text-center py-12">
                        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                            </svg>
                        </div>
                        <h3 class="text-lg font-bold text-gray-900 mb-2">Portföy Bulunamadı</h3>
                        <p class="text-sm text-gray-500 mb-4">
                            <span x-text="currentPortfolioListingType === 'kiralik' ? 'Kiralık' : 'Satılık'"></span>
                            portföyünüz yok.
                        </p>
                        <button
                            class="px-4 py-2 bg-blue-600 text-white rounded-xl text-sm font-medium hover:bg-blue-700 transition-colors">
                            + Yeni Portföy Ekle
                        </button>
                    </div>
                </template>
            </div>

            <!-- FAB Button -->
            <button
                class="fixed bottom-24 right-5 md:bottom-8 md:right-8 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg shadow-blue-300 flex items-center justify-center hover:bg-blue-700 transition-colors z-40">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                </svg>
            </button>
        </div>
        <!-- DEMANDS VIEW -->
        <div x-show="currentTab === 'demands'" class="pb-24 animate-fade-in w-full" x-cloak>
            <!-- Header -->
            <div class="px-5 py-4 border-b border-gray-100">
                <h2 class="text-xl font-bold text-gray-900">Talepler</h2>
                <p class="text-sm text-gray-500 mt-1">Müşteri talepleri</p>
            </div>

            <!-- Tabs -->
            <div class="px-5 mb-4 overflow-x-auto hide-scrollbar">
                <div class="flex gap-6 border-b border-gray-200 min-w-max">
                    <button @click="currentDemandTab = 'active'"
                        class="pb-3 text-sm font-medium transition-colors relative"
                        :class="currentDemandTab === 'active' ? 'text-blue-800 font-bold' : 'text-gray-500'">
                        Taleplerim
                        <span class="ml-1 px-2 py-0.5 rounded-full text-xs transition-colors"
                            :class="currentDemandTab === 'active' ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-600'"
                            x-text="demands.length"></span>
                        <div x-show="currentDemandTab === 'active'"
                            class="absolute bottom-0 left-0 w-full h-0.5 bg-blue-800"></div>
                    </button>
                    <button @click="currentDemandTab = 'network'"
                        class="pb-3 text-sm font-medium transition-colors relative"
                        :class="currentDemandTab === 'network' ? 'text-blue-800 font-bold' : 'text-gray-500'">
                        Ağ Talepleri (Tümü)
                        <span class="ml-1 px-2 py-0.5 rounded-full text-xs transition-colors"
                            :class="currentDemandTab === 'network' ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-600'"
                            x-text="networkDemands.length"></span>
                        <div x-show="currentDemandTab === 'network'"
                            class="absolute bottom-0 left-0 w-full h-0.5 bg-blue-800"></div>
                    </button>
                </div>
            </div>

            <!-- MY DEMANDS LIST (3-column grid) -->
            <div x-show="currentDemandTab === 'active'" class="px-5 py-4 grid grid-cols-2 md:grid-cols-3 gap-3">
                <template x-for="demand in demands" :key="demand.id">
                    <div
                        class="bg-white rounded-2xl border border-gray-100 overflow-hidden shadow-sm hover:shadow-md transition-shadow">
                        <div class="relative">
                            <div
                                class="h-32 bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center">
                                <svg class="w-12 h-12 text-blue-300" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                    </path>
                                </svg>
                            </div>
                            <div class="absolute top-2 left-2 text-white text-xs font-bold px-2 py-1 rounded-lg"
                                :class="demand.type === 'Satılık' ? 'bg-emerald-500' : 'bg-orange-500'"
                                x-text="demand.type"></div>
                            <div x-show="demand.isUrgent"
                                class="absolute top-2 right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-lg">
                                Acil
                            </div>
                        </div>
                        <div class="p-3">
                            <div class="text-blue-600 font-bold text-base mb-1" x-text="formatPrice(demand.budget)">
                            </div>
                            <h3 class="font-bold text-gray-900 text-sm mb-1 truncate" x-text="demand.title">
                            </h3>
                            <p class="text-gray-500 text-xs mb-2 flex items-center gap-1">
                                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
                                        clip-rule="evenodd" />
                                </svg>
                                <span x-text="demand.district"></span>
                            </p>
                            <div class="flex items-center gap-2 text-gray-400 text-xs">
                                <span x-text="demand.rooms"></span>
                                <span>•</span>
                                <span x-text="demand.category"></span>
                            </div>
                            <div class="mt-2 pt-2 border-t border-gray-50 flex items-center justify-between">
                                <span class="text-xs text-gray-500" x-text="demand.matchCount + ' Eşleşme'"></span>
                            </div>
                        </div>
                    </div>
                </template>
            </div>

            <!-- Network Demands List -->
            <div class="px-5 space-y-4" x-show="currentDemandTab === 'network'">
                <template x-for="demand in networkDemands" :key="demand.id">
                    <div class="bg-white rounded-2xl p-5 shadow-soft border border-gray-50">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex gap-3">
                                <div class="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center text-lg font-bold text-purple-600"
                                    x-text="demand.brokerInitials"></div>
                                <div>
                                    <div class="flex items-center gap-2">
                                        <h3 class="font-bold text-gray-900" x-text="demand.brokerName"></h3>
                                        <span
                                            class="bg-purple-100 text-purple-700 text-[10px] px-2 py-0.5 rounded-full font-bold">Broker</span>
                                    </div>

                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="w-2 h-2 rounded-full"
                                    :class="demand.status === 'Hot' ? 'bg-red-500' : 'bg-orange-400'"></span>
                                <span class="text-xs font-medium"
                                    :class="demand.status === 'Hot' ? 'text-red-500' : 'text-orange-500'"
                                    x-text="demand.status"></span>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-y-2 text-sm mb-4">
                            <div class="text-blue-800 font-bold"
                                x-text="formatPrice(demand.budget) + ' - ' + formatPrice(demand.maxBudget)">
                            </div>
                            <div class="flex items-center gap-1 text-gray-600">
                                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z">
                                    </path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                <span class="truncate" x-text="demand.district"></span>
                            </div>
                        </div>

                        <div class="flex flex-wrap gap-2 mb-4">
                            <span
                                class="px-3 py-1 bg-gray-50 rounded-lg text-xs font-medium text-gray-600 border border-gray-100 flex items-center gap-1">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4">
                                    </path>
                                </svg>
                                <span x-text="demand.rooms"></span>
                            </span>
                            <span
                                class="px-3 py-1 bg-gray-50 rounded-lg text-xs font-medium text-gray-600 border border-gray-100 flex items-center gap-1">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                                    </path>
                                </svg>
                                <span x-text="demand.category"></span>
                            </span>
                        </div>

                        <button
                            class="w-full py-2 bg-blue-50 text-blue-600 rounded-xl text-sm font-bold hover:bg-blue-100 transition-colors"
                            @click="alert('Broker ile iletişime geçiliyor: ' + demand.brokerName)">
                            Brokera Mesaj At
                        </button>
                    </div>
                </template>
            </div>
        </div>
        </template>
    </div>
    </div>

    <!-- MATCHING DETAIL VIEW (Overlay) -->
    <div x-show="showMatchDetail" class="fixed inset-0 z-50 bg-gray-100 overflow-y-auto" style="display: none;">
        <!-- Header -->
        <div class="sticky top-0 bg-white px-5 py-4 flex justify-between items-center shadow-sm z-10">
            <button @click="showMatchDetail = false" class="p-2 -ml-2 text-gray-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7">
                    </path>
                </svg>
            </button>
            <h2 class="text-lg font-bold text-gray-900">Eşleşme Analizi</h2>
            <div class="flex gap-2">
                <button class="p-2 text-gray-600"><svg class="w-6 h-6" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z">
                        </path>
                    </svg></button>
            </div>
        </div>

        <!-- Filters -->
        <div class="px-5 py-4 flex gap-3 overflow-x-auto hide-scrollbar">
            <button
                class="px-4 py-2 bg-blue-900 text-white rounded-full text-sm font-bold whitespace-nowrap flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16">
                    </path>
                </svg>
                Tüm Eşleşmeler <span class="bg-white/20 px-1.5 py-0.5 rounded-full text-xs ml-1">4</span>
            </button>
            <button
                class="px-4 py-2 bg-white text-gray-600 border border-gray-200 rounded-full text-sm font-medium whitespace-nowrap flex items-center gap-1 shadow-sm">
                <svg class="w-4 h-4 text-emerald-500" fill="currentColor" viewBox="0 0 20 20">
                    <path
                        d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                </svg>
                %90+ Eşleşme <span class="bg-gray-100 px-1.5 py-0.5 rounded-full text-xs ml-1">1</span>
            </button>
        </div>

        <!-- Match Card -->
        <div class="px-5 pb-24">
            <div class="bg-white rounded-3xl p-5 shadow-soft border border-gray-50 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h3 class="font-bold text-gray-900 text-lg">Eşleşme #001</h3>
                        <p class="text-emerald-600 text-sm font-medium">Mükemmel Eşleşme</p>
                    </div>
                    <div
                        class="bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full text-sm font-bold flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                        </svg>
                        %92
                    </div>
                </div>

                <!-- Comparison -->
                <div class="flex items-center gap-2 mb-6">
                    <div class="flex-1 bg-gray-50 rounded-2xl p-3 border border-gray-100">
                        <img src="https://images.unsplash.com/photo-1600596542815-27b5c028d603?ixlib=rb-4.0.3&auto=format&fit=crop&w=150&q=80"
                            class="w-12 h-12 rounded-xl object-cover mb-2">
                        <div class="font-bold text-gray-900 text-sm truncate">Modern Aile Evi</div>
                        <div class="text-xs text-gray-500 truncate">Bebek, İst.</div>
                        <div class="text-blue-700 font-bold text-xs mt-1">12.5M ₺</div>
                        <div class="text-xs text-gray-400 mt-1">3+1 • 145m²</div>
                    </div>

                    <div class="text-gray-400">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                        </svg>
                    </div>

                    <div class="flex-1 bg-blue-50 rounded-2xl p-3 border border-blue-100">
                        <div
                            class="w-12 h-12 rounded-xl bg-blue-800 flex items-center justify-center text-white font-bold text-sm mb-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z">
                                </path>
                            </svg>
                        </div>
                        <div class="font-bold text-gray-900 text-sm truncate">Talep #001</div>
                        <div class="text-xs text-gray-500 truncate">Bebek, İst.</div>
                        <div class="text-blue-700 font-bold text-xs mt-1">12-14M ₺</div>
                        <div class="text-xs text-gray-400 mt-1">3+1 • Daire</div>
                    </div>
                </div>

                <!-- Criteria Analysis -->
                <div class="mb-6">
                    <h4 class="text-sm font-bold text-gray-500 mb-3 uppercase tracking-wider">Kriter Analizi
                    </h4>
                    <div class="flex flex-wrap gap-2">
                        <span
                            class="px-3 py-1.5 bg-emerald-50 text-emerald-700 rounded-lg text-xs font-bold border border-emerald-100 flex items-center gap-1">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                    d="M5 13l4 4L19 7"></path>
                            </svg>
                            Konum
                        </span>
                        <span
                            class="px-3 py-1.5 bg-emerald-50 text-emerald-700 rounded-lg text-xs font-bold border border-emerald-100 flex items-center gap-1">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                    d="M5 13l4 4L19 7"></path>
                            </svg>
                            Bütçe
                        </span>
                        <span
                            class="px-3 py-1.5 bg-emerald-50 text-emerald-700 rounded-lg text-xs font-bold border border-emerald-100 flex items-center gap-1">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                    d="M5 13l4 4L19 7"></path>
                            </svg>
                            Oda Sayısı
                        </span>
                        <span
                            class="px-3 py-1.5 bg-emerald-50 text-emerald-700 rounded-lg text-xs font-bold border border-emerald-100 flex items-center gap-1">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                    d="M5 13l4 4L19 7"></path>
                            </svg>
                            Tip
                        </span>
                        <span
                            class="px-3 py-1.5 bg-orange-50 text-orange-600 rounded-lg text-xs font-bold border border-orange-100 flex items-center gap-1">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                                </path>
                            </svg>
                            Otopark
                        </span>
                    </div>
                </div>

                <!-- Actions -->
                <div class="flex gap-3">
                    <button
                        class="flex-1 py-3 border border-orange-200 text-orange-600 font-bold rounded-xl hover:bg-orange-50 transition flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                        Reddet
                    </button>
                    <button
                        class="flex-1 py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 transition shadow-lg shadow-emerald-200 flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7">
                            </path>
                        </svg>
                        Onayla
                    </button>
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>

    </div> <!-- End of scroll-content -->

    <!-- FAB Button Wrapper (Mobile Only) -->
    <div class="fixed bottom-0 left-0 w-full h-0 z-50 pointer-events-none md:hidden">
        <button @click="showAddModal = true"
            class="fixed bottom-24 right-5 w-14 h-14 bg-blue-600 rounded-full flex items-center justify-center text-white shadow-lg pointer-events-auto hover:scale-105 transition-transform">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4">
                </path>
            </svg>
        </button>
    </div>

    <!-- Bottom Navigation (Mobile Only) -->
    <div class="mobile-nav absolute bottom-0 left-0 w-full bg-white border-t border-gray-100 pb-safe z-40 md:hidden">
        <div class="flex justify-around items-center py-2">
            <button @click="currentTab = 'dashboard'" class="flex flex-col items-center gap-0.5 py-1"
                :class="currentTab === 'dashboard' ? 'text-blue-600' : 'text-gray-400'">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" />
                </svg>
                <span class="text-[11px] font-medium">Dashboard</span>
            </button>
            <button @click="currentTab = 'portfolios'" class="flex flex-col items-center gap-0.5 py-1"
                :class="currentTab === 'portfolios' ? 'text-blue-600' : 'text-gray-400'">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                </svg>
                <span class="text-[11px] font-medium">Portföyler</span>
            </button>
            <button @click="currentTab = 'demands'" class="flex flex-col items-center gap-0.5 py-1"
                :class="currentTab === 'demands' ? 'text-blue-600' : 'text-gray-400'">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                <span class="text-[11px] font-medium">Talepler</span>
            </button>
            <button @click="currentTab = 'matches'" class="flex flex-col items-center gap-0.5 py-1"
                :class="currentTab === 'matches' ? 'text-blue-600' : 'text-gray-400'">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                </svg>
                <span class="text-[11px] font-medium">Eşleşmeler</span>
            </button>
            <button @click="currentTab = 'network'" class="flex flex-col items-center gap-0.5 py-1"
                :class="currentTab === 'network' ? 'text-blue-600' : 'text-gray-400'">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" />
                </svg>
                <span class="text-[11px] font-medium">Ağ</span>
            </button>
        </div>
    </div>



    </div>
    </div>

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        // Supabase Configuration
        const supabaseUrl = 'https://redwdkfeypnpuyndvysl.supabase.co';
        const supabaseKey = 'sb_publishable_-nD1cds8uhQ80CjphgIG1A__NrAP7v1';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        function app() {
            return {
                // STATE
                user: null,
                authMode: 'login', // login, register
                authEmail: '',
                authPassword: '',
                authName: '',
                authError: '',
                authLoading: false,

                currentTab: 'dashboard',
                currentDemandTab: 'active', // active, pending, completed, archived, network
                currentDemandFilter: 'all', // all, urgent, match
                currentListingType: 'satilik', // satilik, kiralik
                currentCategory: 'all', // all, Villa, Daire, Arsa, İş yeri
                currentCity: 'all',
                currentDistrict: 'all',
                currentPortfolioCity: 'all',
                currentPortfolioDistrict: 'all',
                currentPortfolioListingType: 'satilik', // satilik, kiralik
                currentPortfolioCategory: 'all', // all, Villa, Daire, Arsa, İşyeri
                portfolioSortOrder: 'Tarih', // Tarih, Fiyat (Düşük), Fiyat (Yüksek)
                currentMatchFilter: 'all', // all, top, favorites
                activeConversation: null,
                showMatchDetail: false,
                showAddModal: false,
                newListingImages: [],
                isCompressing: false,
                newPortfolio: {
                    title: '',
                    type: 'Satılık',
                    category: '',
                    price: '',
                    city: 'İstanbul',
                    location: '',
                    district: '',
                    rooms: '',
                    area: '',
                    age: ''
                },
                demands: [],
                portfolios: [],
                networkPortfolios: [],
                networkDemands: [],
                conversations: [],

                get filteredDemands() {
                    let filtered = this.demands;

                    // Filter by Listing Type
                    if (this.currentListingType) {
                        filtered = filtered.filter(d => d.type === (this.currentListingType === 'satilik' ? 'Satılık' : 'Kiralık'));
                    }

                    // Filter by Category
                    if (this.currentCategory !== 'all') {
                        filtered = filtered.filter(d => d.category === this.currentCategory);
                    }

                    // Filter by City
                    if (this.currentCity !== 'all') {
                        filtered = filtered.filter(d => (d.district.split(',')[1]?.trim() || d.district) === this.currentCity);
                    }

                    // Filter by District
                    if (this.currentDistrict !== 'all') {
                        filtered = filtered.filter(d => d.district.split(',')[0]?.trim() === this.currentDistrict);
                    }

                    // Existing Filters
                    if (this.currentDemandFilter === 'urgent') {
                        filtered = filtered.filter(d => d.isUrgent);
                    } else if (this.currentDemandFilter === 'match') {
                        filtered = filtered.filter(d => d.matchCount > 0);
                    }
                    return filtered;
                },

                get filteredMyPortfolios() {
                    let filtered = [...this.portfolios]; // Create a copy to avoid mutating original array

                    // Filter by Listing Type
                    if (this.currentPortfolioListingType) {
                        filtered = filtered.filter(p => p.type === (this.currentPortfolioListingType === 'satilik' ? 'Satılık' : 'Kiralık'));
                    }

                    // Filter by Category
                    if (this.currentPortfolioCategory !== 'all') {
                        filtered = filtered.filter(p => p.category === this.currentPortfolioCategory);
                    }

                    // Sort
                    if (this.portfolioSortOrder === 'Fiyat (Düşük)') {
                        filtered.sort((a, b) => a.price - b.price);
                    } else if (this.portfolioSortOrder === 'Fiyat (Yüksek)') {
                        filtered.sort((a, b) => b.price - a.price);
                    } else {
                        // Tarih (Varsayılan - Yeni en üstte)
                        filtered.sort((a, b) => {
                            // created_at varsa kullan, yoksa id (büyük id = yeni)
                            if (a.created_at && b.created_at) {
                                return new Date(b.created_at) - new Date(a.created_at);
                            }
                            return b.id - a.id;
                        });
                    }


                    if (this.currentPortfolioCity !== 'all') {
                        filtered = filtered.filter(p => (p.district.split(',')[1]?.trim() || p.district) === this.currentPortfolioCity);
                    }
                    if (this.currentPortfolioDistrict !== 'all') {
                        filtered = filtered.filter(p => p.district.split(',')[0]?.trim() === this.currentPortfolioDistrict);
                    }
                    return filtered;
                },

                get filteredNetworkPortfolios() {
                    let filtered = this.networkPortfolios;

                    // Filter by Listing Type
                    if (this.currentPortfolioListingType) {
                        filtered = filtered.filter(p => p.type === (this.currentPortfolioListingType === 'satilik' ? 'Satılık' : 'Kiralık'));
                    }

                    if (this.currentPortfolioCity !== 'all') {
                        filtered = filtered.filter(p => (p.district.split(',')[1]?.trim() || p.district) === this.currentPortfolioCity);
                    }
                    if (this.currentPortfolioDistrict !== 'all') {
                        filtered = filtered.filter(p => p.district.split(',')[0]?.trim() === this.currentPortfolioDistrict);
                    }
                    return filtered;
                },

                async init() {
                    // Check active session
                    const { data: { session } } = await supabase.auth.getSession();
                    this.user = session?.user || null;

                    // Listen for auth changes
                    supabase.auth.onAuthStateChange((_event, session) => {
                        this.user = session?.user || null;
                        if (this.user) {
                            this.fetchData();
                        }
                    });

                    if (this.user) {
                        this.fetchData();
                    }
                },

                async fetchData() {
                    try {
                        if (!this.user) {
                            console.log('FetchData: No user logged in');
                            return;
                        }
                        console.log('FetchData: Fetching for user:', this.user.id);

                        // Fetch Demands
                        const { data: demands, error: demandError } = await supabase.from('demands').select('*');
                        if (demandError) {
                            console.error('Error fetching demands:', demandError);
                            alert('Error fetching demands: ' + demandError.message);
                        }
                        console.log('Fetched Demands (No Filter):', demands);
                        if (demands && demands.length > 0) {
                            // Test Users Data
                            const testUsers = [
                                { name: 'Mehmet Demir', image: 'https://i.pravatar.cc/150?img=3' },
                                { name: 'Ayşe Kaya', image: 'https://i.pravatar.cc/150?img=5' },
                                { name: 'Can Yıldız', image: 'https://i.pravatar.cc/150?img=8' },
                                { name: 'Zeynep Çelik', image: 'https://i.pravatar.cc/150?img=9' },
                                { name: 'Ali Yılmaz', image: 'https://i.pravatar.cc/150?img=11' }
                            ];

                            this.demands = demands.map((d, index) => {
                                const randomUser = testUsers[Math.floor(Math.random() * testUsers.length)];
                                const type = Math.random() > 0.3 ? 'Satılık' : 'Kiralık';
                                // Logic: Sale prices higher than Rent prices
                                const budget = type === 'Satılık'
                                    ? Math.floor(Math.random() * 49000000) + 1000000 // 1M - 50M
                                    : Math.floor(Math.random() * 190000) + 10000;    // 10k - 200k

                                return {
                                    ...d,
                                    budget: budget, // Override budget for demo logic
                                    maxBudget: budget * 1.2,
                                    image: randomUser.image,
                                    name: randomUser.name,
                                    matchCount: Math.floor(Math.random() * 5) + 1,
                                    isUrgent: index === 0 || Math.random() > 0.7,
                                    type: type,
                                    category: ['Villa', 'Daire', 'Arsa', 'İş yeri'][Math.floor(Math.random() * 4)]
                                };
                            });
                        }

                        // Fetch Portfolios
                        const { data: portfolios, error: portfolioError } = await supabase.from('portfolios').select('*');
                        if (portfolioError) {
                            console.error('Error fetching portfolios:', portfolioError);
                            alert('Error fetching portfolios: ' + portfolioError.message);
                        }
                        console.log('Fetched Portfolios (No Filter):', portfolios);
                        if (portfolios && portfolios.length > 0) {
                            this.portfolios = portfolios.map(p => ({
                                ...p,
                                image: p.image_url || p.image,
                                location: p.location || p.district,
                                district: p.district,
                                rooms: p.rooms,
                                area: p.area || '-',
                                age: p.age || '-',
                                // Workaround: Assign type based on price (since DB doesn't have type column)
                                // Rental (Kiralık) properties have lower monthly prices (< 100k)
                                type: p.type || (p.price <= 100000 ? 'Kiralık' : 'Satılık'),
                                category: p.category,
                                features: p.features || []
                            }));
                        }

                        // Fetch Matches
                        const { data: matches, error: matchError } = await supabase.from('matches').select('*, demand:demands(*), portfolio:portfolios(*)');
                        if (matchError) {
                            console.error('Error fetching matches:', matchError);
                            alert('Error fetching matches: ' + matchError.message);
                        }
                        console.log('Fetched Matches:', matches);
                        if (matches && matches.length > 0) {
                            this.matches = matches.map(m => ({
                                ...m,
                                title: m.portfolio?.title,
                                name: 'Ahmet Yılmaz', // Client name
                                price: this.formatPrice(m.portfolio?.price),
                                location: m.portfolio?.district,
                                specs: `${m.portfolio?.rooms} • ${m.portfolio?.category}`,
                                score: m.score || 95,
                                isFavorite: false
                            }));
                        }

                        // MOCK DATA RESTORATION (For Demo Purposes)

                        // 1. Mock Conversations
                        this.conversations = [
                            { id: 1, name: 'Mehmet Demir', message: 'Merhaba, ilanınızla ilgileniyorum.', time: '10:30', unread: 2, avatar: 'https://i.pravatar.cc/150?img=3' },
                            { id: 2, name: 'Ayşe Kaya', message: 'Randevu için müsait misiniz?', time: 'Dün', unread: 0, avatar: 'https://i.pravatar.cc/150?img=5' },
                            { id: 3, name: 'Can Yıldız', message: 'Fiyat konusunda son ne olur?', time: 'Pzt', unread: 0, avatar: 'https://i.pravatar.cc/150?img=8' }
                        ];

                        // 2. Mock Network (Brokers)
                        this.network = [
                            { id: 1, name: 'Mehmet Demir', role: 'Lüks Konut Uzmanı', company: 'Remax', score: 98, avatar: 'https://i.pravatar.cc/150?img=3' },
                            { id: 2, name: 'Ayşe Kaya', role: 'Ticari Gayrimenkul', company: 'Keller Williams', score: 95, avatar: 'https://i.pravatar.cc/150?img=5' },
                            { id: 3, name: 'Can Yıldız', role: 'Arsa & Arazi', company: 'Century 21', score: 92, avatar: 'https://i.pravatar.cc/150?img=8' },
                            { id: 4, name: 'Zeynep Çelik', role: 'Konut Danışmanı', company: 'Coldwell Banker', score: 89, avatar: 'https://i.pravatar.cc/150?img=9' }
                        ];

                        // 3. Mock Network Portfolios
                        this.networkPortfolios = [
                            { id: 101, title: 'Nişantaşı Lüks Daire', price: 65000000, district: 'Nişantaşı, Şişli', rooms: '3+1', category: 'Daire', type: 'Satılık', image: 'https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?auto=format&fit=crop&w=800&q=80', brokerName: 'Mehmet Demir' },
                            { id: 102, title: 'Etiler Bahçeli Villa', price: 125000000, district: 'Etiler, Beşiktaş', rooms: '5+2', category: 'Villa', type: 'Satılık', image: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?auto=format&fit=crop&w=800&q=80', brokerName: 'Ayşe Kaya' },
                            { id: 103, title: 'Maslak Plaza Ofis', price: 45000000, district: 'Maslak, Sarıyer', rooms: '250m²', category: 'Ofis', type: 'Satılık', image: 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=800&q=80', brokerName: 'Can Yıldız' }
                        ];

                        // 4. Mock Network Demands
                        this.networkDemands = [
                            { id: 201, brokerName: 'Mehmet Demir', brokerInitials: 'MD', status: 'Hot', budget: 50000000, maxBudget: 60000000, district: 'Beşiktaş', rooms: '3+1', category: 'Daire' },
                            { id: 202, brokerName: 'Ayşe Kaya', brokerInitials: 'AK', status: 'Warm', budget: 30000000, maxBudget: 35000000, district: 'Kadıköy', rooms: '2+1', category: 'Daire' },
                            { id: 203, brokerName: 'Zeynep Çelik', brokerInitials: 'ZÇ', status: 'Cold', budget: 15000000, maxBudget: 18000000, district: 'Çekmeköy', rooms: '4+1', category: 'Daire' }
                        ];
                    } catch (e) {
                        console.error('CRITICAL ERROR in fetchData:', e);
                        alert('Bir hata oluştu: ' + e.message);
                    }
                },

                async seedData() {
                    if (!this.user) return;
                    if (!confirm('Veritabanına örnek veriler eklenecek. Onaylıyor musunuz?')) return;

                    console.log('SeedData: Starting seed for user:', this.user.id);

                    // 1. Create/Update Profile
                    const { error: profileError } = await supabase.from('profiles').update({ name: 'Ahmet Yılmaz', role: 'broker' }).eq('id', this.user.id);
                    if (profileError) console.error('SeedData: Profile update error:', profileError);
                    else console.log('SeedData: Profile updated');

                    // 2. Insert Demands
                    const mockDemands = [
                        { user_id: this.user.id, title: 'Bebek Sahil Lüks Daire', budget: 45000000, max_budget: 55000000, district: 'Bebek, Beşiktaş', rooms: '3+1', category: 'Daire', status: 'active' },
                        { user_id: this.user.id, title: 'Yeniköy Boğaz Manzaralı Villa', budget: 85000000, max_budget: 100000000, district: 'Yeniköy, Sarıyer', rooms: '5+1', category: 'Villa', status: 'pending' },
                        { user_id: this.user.id, title: 'Suadiye Bağdat Caddesi Yakını', budget: 25000000, max_budget: 30000000, district: 'Suadiye, Kadıköy', rooms: '4+1', category: 'Daire', status: 'active' }
                    ];
                    const { data: demandData, error: demandError } = await supabase.from('demands').insert(mockDemands).select();
                    if (demandError) console.error('SeedData: Demand insert error:', demandError);
                    else console.log('SeedData: Demands inserted:', demandData);

                    // 3. Insert Portfolios - 24 total (12 Satılık, 12 Kiralık)
                    const mockPortfolios = [
                        // SATILIK - Villa (3)
                        { user_id: this.user.id, title: 'Bahçeli Müstakil Villa', price: 1200000, location: 'Sarıyer', district: 'Sarıyer, İstanbul', rooms: '5+1', area: '250m²', age: '2y', type: 'Satılık', category: 'Villa', features: ['Havuz', 'Bahçe'], image_url: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Boğaz Manzaralı Villa', price: 2500000, location: 'Bebek', district: 'Bebek, İstanbul', rooms: '6+2', area: '350m²', age: '4y', type: 'Satılık', category: 'Villa', features: ['Deniz Manzarası', 'Jakuzi'], image_url: 'https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Modern Villa', price: 1800000, location: 'Zekeriyaköy', district: 'Zekeriyaköy, İstanbul', rooms: '4+2', area: '280m²', age: '1y', type: 'Satılık', category: 'Villa', features: ['Akıllı Ev', 'Garaj'], image_url: 'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?auto=format&fit=crop&w=800&q=80' },
                        // SATILIK - Daire (3)
                        { user_id: this.user.id, title: 'Modern Aile Dairesi', price: 450000, location: 'Kadıköy', district: 'Kadıköy, İstanbul', rooms: '3+1', area: '140m²', age: '5y', type: 'Satılık', category: 'Daire', features: ['Otopark', 'Asansör'], image_url: 'https://images.unsplash.com/photo-1600596542815-2495db9dc2c3?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Deniz Manzaralı Daire', price: 890000, location: 'Beşiktaş', district: 'Beşiktaş, İstanbul', rooms: '4+1', area: '180m²', age: '2y', type: 'Satılık', category: 'Daire', features: ['Otopark', 'Güvenlik'], image_url: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Lüks Rezidans', price: 750000, location: 'Levent', district: 'Levent, İstanbul', rooms: '2+1', area: '120m²', age: '3y', type: 'Satılık', category: 'Daire', features: ['Spor Salonu', 'Havuz'], image_url: 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=800&q=80' },
                        // SATILIK - Arsa (3)
                        { user_id: this.user.id, title: 'Yatırımlık Arsa', price: 850000, location: 'Çekmeköy', district: 'Çekmeköy, İstanbul', rooms: '-', area: '500m²', age: '-', type: 'Satılık', category: 'Arsa', features: ['İmarlı'], image_url: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Denize Sıfır Arsa', price: 1500000, location: 'Şile', district: 'Şile, İstanbul', rooms: '-', area: '1000m²', age: '-', type: 'Satılık', category: 'Arsa', features: ['Deniz Manzarası'], image_url: 'https://images.unsplash.com/photo-1628624747186-a941c476b7ef?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Köy Arsası', price: 350000, location: 'Silivri', district: 'Silivri, İstanbul', rooms: '-', area: '2000m²', age: '-', type: 'Satılık', category: 'Arsa', features: ['Tarla'], image_url: 'https://images.unsplash.com/photo-1625246333195-78d9c38ad449?auto=format&fit=crop&w=800&q=80' },
                        // SATILIK - İşyeri (3)
                        { user_id: this.user.id, title: 'Cadde Üzeri Dükkan', price: 950000, location: 'Bakırköy', district: 'Bakırköy, İstanbul', rooms: '-', area: '85m²', age: '8y', type: 'Satılık', category: 'İşyeri', features: ['Vitrin', 'Depo'], image_url: 'https://images.unsplash.com/photo-1441986300917-64674bd600d8?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Plaza Ofis', price: 1200000, location: 'Maslak', district: 'Maslak, İstanbul', rooms: '3+1', area: '150m²', age: '5y', type: 'Satılık', category: 'İşyeri', features: ['Otopark', 'Toplantı Odası'], image_url: 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Fabrika Binası', price: 3500000, location: 'Tuzla', district: 'Tuzla, İstanbul', rooms: '-', area: '2000m²', age: '15y', type: 'Satılık', category: 'İşyeri', features: ['Yükleme Rampası'], image_url: 'https://images.unsplash.com/photo-1553062407-98eeb64c6a62?auto=format&fit=crop&w=800&q=80' },
                        // KIRALIK - Villa (3)
                        { user_id: this.user.id, title: 'Kiralık Havuzlu Villa', price: 45000, location: 'Zekeriyaköy', district: 'Zekeriyaköy, İstanbul', rooms: '4+2', area: '280m²', age: '2y', type: 'Kiralık', category: 'Villa', features: ['Bahçe', 'Havuz'], image_url: 'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Deniz Kenarı Villa', price: 65000, location: 'Dragos', district: 'Dragos, İstanbul', rooms: '5+1', area: '320m²', age: '3y', type: 'Kiralık', category: 'Villa', features: ['Deniz Manzarası', 'İskele'], image_url: 'https://images.unsplash.com/photo-1580587771525-78b9dba3b914?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Orman Manzaralı Villa', price: 35000, location: 'Kemerburgaz', district: 'Kemerburgaz, İstanbul', rooms: '4+1', area: '240m²', age: '4y', type: 'Kiralık', category: 'Villa', features: ['Şömine', 'Bahçe'], image_url: 'https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?auto=format&fit=crop&w=800&q=80' },
                        // KIRALIK - Daire (3)
                        { user_id: this.user.id, title: 'Rezidans Dairesi', price: 25000, location: 'Levent', district: 'Levent, İstanbul', rooms: '2+1', area: '110m²', age: '3y', type: 'Kiralık', category: 'Daire', features: ['Spor Salonu', 'Havuz'], image_url: 'https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Merkezi Daire', price: 18000, location: 'Şişli', district: 'Şişli, İstanbul', rooms: '3+1', area: '130m²', age: '6y', type: 'Kiralık', category: 'Daire', features: ['Metro Yakını', 'Asansör'], image_url: 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Boğaz Manzaralı Daire', price: 40000, location: 'Ortaköy', district: 'Ortaköy, İstanbul', rooms: '3+1', area: '145m²', age: '2y', type: 'Kiralık', category: 'Daire', features: ['Balkon', 'Manzara'], image_url: 'https://images.unsplash.com/photo-1493809842364-78817add7ffb?auto=format&fit=crop&w=800&q=80' },
                        // KIRALIK - Arsa (3)
                        { user_id: this.user.id, title: 'Otopark Arsası', price: 8000, location: 'Kadıköy', district: 'Kadıköy, İstanbul', rooms: '-', area: '300m²', age: '-', type: 'Kiralık', category: 'Arsa', features: ['Asfalt'], image_url: 'https://images.unsplash.com/photo-1590674899484-d5640e854abe?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Depolama Alanı', price: 12000, location: 'Ümraniye', district: 'Ümraniye, İstanbul', rooms: '-', area: '500m²', age: '-', type: 'Kiralık', category: 'Arsa', features: ['Güvenlik'], image_url: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Açık Hava Etkinlik Alanı', price: 15000, location: 'Beykoz', district: 'Beykoz, İstanbul', rooms: '-', area: '1500m²', age: '-', type: 'Kiralık', category: 'Arsa', features: ['Elektrik', 'Su'], image_url: 'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=800&q=80' },
                        // KIRALIK - İşyeri (3)
                        { user_id: this.user.id, title: 'Merkezi Lüks Ofis', price: 15000, location: 'Şişli', district: 'Şişli, İstanbul', rooms: '2+1', area: '95m²', age: '8y', type: 'Kiralık', category: 'İşyeri', features: ['Otopark'], image_url: 'https://images.unsplash.com/photo-1497366811353-6870744d04b2?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'AVM Dükkanı', price: 35000, location: 'Nişantaşı', district: 'Nişantaşı, İstanbul', rooms: '-', area: '75m²', age: '10y', type: 'Kiralık', category: 'İşyeri', features: ['Vitrin', 'Yaya Trafiği'], image_url: 'https://images.unsplash.com/photo-1604719312566-8912e9227c6a?auto=format&fit=crop&w=800&q=80' },
                        { user_id: this.user.id, title: 'Restoran Alanı', price: 28000, location: 'Karaköy', district: 'Karaköy, İstanbul', rooms: '-', area: '200m²', age: '12y', type: 'Kiralık', category: 'İşyeri', features: ['Mutfak', 'Teras'], image_url: 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&w=800&q=80' }
                    ];
                    const { data: portfolioData, error: portfolioError } = await supabase.from('portfolios').insert(mockPortfolios).select();
                    if (portfolioError) console.error('SeedData: Portfolio insert error:', portfolioError);
                    else console.log('SeedData: Portfolios inserted:', portfolioData);

                    alert('Veriler başarıyla eklendi! Sayfa yenileniyor...');
                    window.location.reload();
                },

                handleImageUpload(event) {
                    const file = event.target.files[0];
                    if (!file) return;

                    // Dosya boyutu kontrolü (max 2MB)
                    if (file.size > 2 * 1024 * 1024) {
                        alert('Dosya boyutu 2MB\'dan küçük olmalıdır.');
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        this.newListingImages = [e.target.result];
                    };
                    reader.readAsDataURL(file);
                },

                async saveNewPortfolio() {
                    try {
                        // Validation
                        if (!this.newPortfolio.title || !this.newPortfolio.category || !this.newPortfolio.price) {
                            alert('Lütfen zorunlu alanları doldurun (Başlık, Kategori, Fiyat)');
                            return;
                        }

                        if (!this.user) {
                            alert('Lütfen giriş yapın');
                            return;
                        }

                        // Prepare data for Supabase
                        const portfolioData = {
                            user_id: this.user.id,
                            title: this.newPortfolio.title,
                            price: parseInt(this.newPortfolio.price),
                            type: this.newPortfolio.type,
                            category: this.newPortfolio.category,
                            rooms: this.newPortfolio.rooms || '-',
                            // Format: "Semt, İlçe, Şehir" or "İlçe, Şehir" or "Şehir"
                            district: [
                                this.newPortfolio.district,
                                this.newPortfolio.location,
                                this.newPortfolio.city || 'İstanbul'
                            ].filter(Boolean).join(', '),
                            image_url: this.newListingImages[0] || 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=800&q=80'
                        };

                        // Insert to Supabase
                        const { data, error } = await supabase
                            .from('portfolios')
                            .insert([portfolioData])
                            .select();

                        if (error) {
                            console.error('Error saving portfolio:', error);
                            alert('Kayıt sırasında hata oluştu: ' + error.message);
                            return;
                        }

                        console.log('Portfolio saved:', data);

                        // Refresh data
                        await this.fetchData();

                        // Close modal and reset form
                        this.showAddModal = false;
                        this.newPortfolio = {
                            title: '',
                            type: 'Satılık',
                            category: '',
                            price: '',
                            city: 'İstanbul',
                            location: '',
                            district: '',
                            rooms: '',
                            area: '',
                            age: ''
                        };
                        this.newListingImages = [];

                        alert('Portföy başarıyla eklendi!');
                    } catch (e) {
                        console.error('Error:', e);
                        alert('Bir hata oluştu: ' + e.message);
                    }
                },

                async handleAuth() {
                    this.authLoading = true;
                    this.authError = '';

                    try {
                        if (this.authMode === 'login') {
                            const { error } = await supabase.auth.signInWithPassword({
                                email: this.authEmail,
                                password: this.authPassword
                            });
                            if (error) throw error;
                        } else {
                            const { error } = await supabase.auth.signUp({
                                email: this.authEmail,
                                password: this.authPassword,
                                options: {
                                    data: {
                                        name: this.authName
                                    }
                                }
                            });
                            if (error) throw error;
                            alert('Kayıt başarılı! Lütfen giriş yapın.');
                            this.authMode = 'login';
                        }
                    } catch (e) {
                        this.authError = e.message;
                    } finally {
                        this.authLoading = false;
                    }
                },

                async logout() {
                    await supabase.auth.signOut();
                    this.user = null;
                    this.demands = [];
                    this.portfolios = [];
                    this.matches = [];
                },

                // DATA ARRAYS
                conversations: [
                    { id: 1, name: 'Mehmet Demir', message: 'Merhaba, ilanınızla ilgileniyorum.', time: '10:30', unread: 2, avatar: 'https://i.pravatar.cc/150?img=3' },
                    { id: 2, name: 'Ayşe Kaya', message: 'Randevu için müsait misiniz?', time: 'Dün', unread: 0, avatar: 'https://i.pravatar.cc/150?img=5' },
                    { id: 3, name: 'Can Yıldız', message: 'Fiyat konusunda son ne olur?', time: 'Pzt', unread: 0, avatar: 'https://i.pravatar.cc/150?img=8' }
                ],
                demands: [
                    { id: 1, title: 'Bebek Sahil Lüks Daire', budget: 45000000, maxBudget: 55000000, district: 'Bebek, Beşiktaş', rooms: '3+1', category: 'Daire', status: 'active', image: 'https://i.pravatar.cc/150?u=1', name: 'Ahmet Yılmaz', matchCount: 3, isUrgent: true },
                    { id: 2, title: 'Yeniköy Boğaz Manzaralı Villa', budget: 85000000, maxBudget: 100000000, district: 'Yeniköy, Sarıyer', rooms: '5+1', category: 'Villa', status: 'pending', image: 'https://i.pravatar.cc/150?u=2', name: 'Ahmet Yılmaz', matchCount: 1, isUrgent: false },
                    { id: 3, title: 'Suadiye Bağdat Caddesi Yakını', budget: 25000000, maxBudget: 30000000, district: 'Suadiye, Kadıköy', rooms: '4+1', category: 'Daire', status: 'active', image: 'https://i.pravatar.cc/150?u=3', name: 'Ahmet Yılmaz', matchCount: 5, isUrgent: false }
                ],
                networkDemands: [
                    { id: 201, brokerName: 'Mehmet Demir', brokerInitials: 'MD', status: 'Hot', budget: 50000000, maxBudget: 60000000, district: 'Beşiktaş', rooms: '3+1', category: 'Daire' },
                    { id: 202, brokerName: 'Ayşe Kaya', brokerInitials: 'AK', status: 'Warm', budget: 30000000, maxBudget: 35000000, district: 'Kadıköy', rooms: '2+1', category: 'Daire' },
                    { id: 203, brokerName: 'Zeynep Çelik', brokerInitials: 'ZÇ', status: 'Cold', budget: 15000000, maxBudget: 18000000, district: 'Çekmeköy', rooms: '4+1', category: 'Daire' }
                ],
                portfolios: [
                    // SATILIK - Villa (3)
                    { id: 1, title: 'Bahçeli Müstakil Villa', price: 1200000, location: 'Sarıyer', district: 'Sarıyer, İstanbul', rooms: '5+1', area: '250m²', age: '2y', type: 'Satılık', category: 'Villa', features: ['Havuz', 'Bahçe'], image: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?auto=format&fit=crop&w=800&q=80' },
                    { id: 2, title: 'Boğaz Manzaralı Villa', price: 2500000, location: 'Bebek', district: 'Bebek, İstanbul', rooms: '6+2', area: '350m²', age: '4y', type: 'Satılık', category: 'Villa', features: ['Deniz Manzarası', 'Jakuzi'], image: 'https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3?auto=format&fit=crop&w=800&q=80' },
                    { id: 3, title: 'Modern Villa', price: 1800000, location: 'Zekeriyaköy', district: 'Zekeriyaköy, İstanbul', rooms: '4+2', area: '280m²', age: '1y', type: 'Satılık', category: 'Villa', features: ['Akıllı Ev', 'Garaj'], image: 'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?auto=format&fit=crop&w=800&q=80' },
                    // SATILIK - Daire (3)
                    { id: 4, title: 'Modern Aile Dairesi', price: 450000, location: 'Kadıköy', district: 'Kadıköy, İstanbul', rooms: '3+1', area: '140m²', age: '5y', type: 'Satılık', category: 'Daire', features: ['Otopark', 'Asansör'], image: 'https://images.unsplash.com/photo-1600596542815-2495db9dc2c3?auto=format&fit=crop&w=800&q=80' },
                    { id: 5, title: 'Deniz Manzaralı Daire', price: 890000, location: 'Beşiktaş', district: 'Beşiktaş, İstanbul', rooms: '4+1', area: '180m²', age: '2y', type: 'Satılık', category: 'Daire', features: ['Otopark', 'Güvenlik'], image: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?auto=format&fit=crop&w=800&q=80' },
                    { id: 6, title: 'Lüks Rezidans', price: 750000, location: 'Levent', district: 'Levent, İstanbul', rooms: '2+1', area: '120m²', age: '3y', type: 'Satılık', category: 'Daire', features: ['Spor Salonu', 'Havuz'], image: 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=800&q=80' },
                    // SATILIK - Arsa (3)
                    { id: 7, title: 'Yatırımlık Arsa', price: 850000, location: 'Çekmeköy', district: 'Çekmeköy, İstanbul', rooms: '-', area: '500m²', age: '-', type: 'Satılık', category: 'Arsa', features: ['İmarlı'], image: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?auto=format&fit=crop&w=800&q=80' },
                    { id: 8, title: 'Denize Sıfır Arsa', price: 1500000, location: 'Şile', district: 'Şile, İstanbul', rooms: '-', area: '1000m²', age: '-', type: 'Satılık', category: 'Arsa', features: ['Deniz Manzarası'], image: 'https://images.unsplash.com/photo-1628624747186-a941c476b7ef?auto=format&fit=crop&w=800&q=80' },
                    { id: 9, title: 'Köy Arsası', price: 350000, location: 'Silivri', district: 'Silivri, İstanbul', rooms: '-', area: '2000m²', age: '-', type: 'Satılık', category: 'Arsa', features: ['Tarla'], image: 'https://images.unsplash.com/photo-1625246333195-78d9c38ad449?auto=format&fit=crop&w=800&q=80' },
                    // SATILIK - İşyeri (3)
                    { id: 10, title: 'Cadde Üzeri Dükkan', price: 950000, location: 'Bakırköy', district: 'Bakırköy, İstanbul', rooms: '-', area: '85m²', age: '8y', type: 'Satılık', category: 'İşyeri', features: ['Vitrin', 'Depo'], image: 'https://images.unsplash.com/photo-1441986300917-64674bd600d8?auto=format&fit=crop&w=800&q=80' },
                    { id: 11, title: 'Plaza Ofis', price: 1200000, location: 'Maslak', district: 'Maslak, İstanbul', rooms: '3+1', area: '150m²', age: '5y', type: 'Satılık', category: 'İşyeri', features: ['Otopark', 'Toplantı Odası'], image: 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=800&q=80' },
                    { id: 12, title: 'Fabrika Binası', price: 3500000, location: 'Tuzla', district: 'Tuzla, İstanbul', rooms: '-', area: '2000m²', age: '15y', type: 'Satılık', category: 'İşyeri', features: ['Yükleme Rampası'], image: 'https://images.unsplash.com/photo-1553062407-98eeb64c6a62?auto=format&fit=crop&w=800&q=80' },
                    // KIRALIK - Villa (3)
                    { id: 13, title: 'Kiralık Havuzlu Villa', price: 45000, location: 'Zekeriyaköy', district: 'Zekeriyaköy, İstanbul', rooms: '4+2', area: '280m²', age: '2y', type: 'Kiralık', category: 'Villa', features: ['Bahçe', 'Havuz'], image: 'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?auto=format&fit=crop&w=800&q=80' },
                    { id: 14, title: 'Deniz Kenarı Villa', price: 65000, location: 'Dragos', district: 'Dragos, İstanbul', rooms: '5+1', area: '320m²', age: '3y', type: 'Kiralık', category: 'Villa', features: ['Deniz Manzarası', 'İskele'], image: 'https://images.unsplash.com/photo-1580587771525-78b9dba3b914?auto=format&fit=crop&w=800&q=80' },
                    { id: 15, title: 'Orman Manzaralı Villa', price: 35000, location: 'Kemerburgaz', district: 'Kemerburgaz, İstanbul', rooms: '4+1', area: '240m²', age: '4y', type: 'Kiralık', category: 'Villa', features: ['Şömine', 'Bahçe'], image: 'https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?auto=format&fit=crop&w=800&q=80' },
                    // KIRALIK - Daire (3)
                    { id: 16, title: 'Rezidans Dairesi', price: 25000, location: 'Levent', district: 'Levent, İstanbul', rooms: '2+1', area: '110m²', age: '3y', type: 'Kiralık', category: 'Daire', features: ['Spor Salonu', 'Havuz'], image: 'https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?auto=format&fit=crop&w=800&q=80' },
                    { id: 17, title: 'Merkezi Daire', price: 18000, location: 'Şişli', district: 'Şişli, İstanbul', rooms: '3+1', area: '130m²', age: '6y', type: 'Kiralık', category: 'Daire', features: ['Metro Yakını', 'Asansör'], image: 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?auto=format&fit=crop&w=800&q=80' },
                    { id: 18, title: 'Boğaz Manzaralı Daire', price: 40000, location: 'Ortaköy', district: 'Ortaköy, İstanbul', rooms: '3+1', area: '145m²', age: '2y', type: 'Kiralık', category: 'Daire', features: ['Balkon', 'Manzara'], image: 'https://images.unsplash.com/photo-1493809842364-78817add7ffb?auto=format&fit=crop&w=800&q=80' },
                    // KIRALIK - Arsa (3)
                    { id: 19, title: 'Otopark Arsası', price: 8000, location: 'Kadıköy', district: 'Kadıköy, İstanbul', rooms: '-', area: '300m²', age: '-', type: 'Kiralık', category: 'Arsa', features: ['Asfalt'], image: 'https://images.unsplash.com/photo-1590674899484-d5640e854abe?auto=format&fit=crop&w=800&q=80' },
                    { id: 20, title: 'Depolama Alanı', price: 12000, location: 'Ümraniye', district: 'Ümraniye, İstanbul', rooms: '-', area: '500m²', age: '-', type: 'Kiralık', category: 'Arsa', features: ['Güvenlik'], image: 'https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?auto=format&fit=crop&w=800&q=80' },
                    { id: 21, title: 'Açık Hava Etkinlik Alanı', price: 15000, location: 'Beykoz', district: 'Beykoz, İstanbul', rooms: '-', area: '1500m²', age: '-', type: 'Kiralık', category: 'Arsa', features: ['Elektrik', 'Su'], image: 'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=800&q=80' },
                    // KIRALIK - İşyeri (3)
                    { id: 22, title: 'Merkezi Lüks Ofis', price: 15000, location: 'Şişli', district: 'Şişli, İstanbul', rooms: '2+1', area: '95m²', age: '8y', type: 'Kiralık', category: 'İşyeri', features: ['Otopark'], image: 'https://images.unsplash.com/photo-1497366811353-6870744d04b2?auto=format&fit=crop&w=800&q=80' },
                    { id: 23, title: 'AVM Dükkanı', price: 35000, location: 'Nişantaşı', district: 'Nişantaşı, İstanbul', rooms: '-', area: '75m²', age: '10y', type: 'Kiralık', category: 'İşyeri', features: ['Vitrin', 'Yaya Trafiği'], image: 'https://images.unsplash.com/photo-1604719312566-8912e9227c6a?auto=format&fit=crop&w=800&q=80' },
                    { id: 24, title: 'Restoran Alanı', price: 28000, location: 'Karaköy', district: 'Karaköy, İstanbul', rooms: '-', area: '200m²', age: '12y', type: 'Kiralık', category: 'İşyeri', features: ['Mutfak', 'Teras'], image: 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&w=800&q=80' }
                ],
                networkPortfolios: [
                    { id: 101, title: 'Nişantaşı Lüks Daire', price: 65000000, district: 'Nişantaşı, Şişli', rooms: '3+1', category: 'Daire', type: 'Satılık', image: 'https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?auto=format&fit=crop&w=800&q=80', brokerName: 'Mehmet Demir' },
                    { id: 102, title: 'Etiler Bahçeli Villa', price: 125000000, district: 'Etiler, Beşiktaş', rooms: '5+2', category: 'Villa', type: 'Satılık', image: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?auto=format&fit=crop&w=800&q=80', brokerName: 'Ayşe Kaya' },
                    { id: 103, title: 'Maslak Plaza Ofis', price: 45000000, district: 'Maslak, Sarıyer', rooms: '250m²', category: 'Ofis', type: 'Satılık', image: 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=800&q=80', brokerName: 'Can Yıldız' }
                ],
                matches: [
                    { id: 1, title: 'Boğaz Manzaralı Lüks Daire', price: '48.0M ₺', location: 'Arnavutköy, Beşiktaş', specs: '3+1 • Daire', score: 98, isFavorite: false, name: 'Ahmet Yılmaz' },
                    { id: 2, title: 'Panoramik Deniz Manzaralı', price: '32.0M ₺', location: 'Fenerbahçe, Kadıköy', specs: '4+1 • Daire', score: 95, isFavorite: true, name: 'Ahmet Yılmaz' },
                    { id: 3, title: 'Nişantaşı Lüks Daire', price: '65.0M ₺', location: 'Nişantaşı, Şişli', specs: '3+1 • Daire', score: 92, isFavorite: false, name: 'Mehmet Demir' }
                ],
                network: [
                    { id: 1, name: 'Mehmet Demir', role: 'Lüks Konut Uzmanı', company: 'Remax', score: 98, avatar: 'https://i.pravatar.cc/150?img=3' },
                    { id: 2, name: 'Ayşe Kaya', role: 'Ticari Gayrimenkul', company: 'Keller Williams', score: 95, avatar: 'https://i.pravatar.cc/150?img=5' },
                    { id: 3, name: 'Can Yıldız', role: 'Arsa & Arazi', company: 'Century 21', score: 92, avatar: 'https://i.pravatar.cc/150?img=8' },
                    { id: 4, name: 'Zeynep Çelik', role: 'Konut Danışmanı', company: 'Coldwell Banker', score: 89, avatar: 'https://i.pravatar.cc/150?img=9' }
                ],
                networkActivities: [
                    { id: 1, user: 'Selin Yılmaz', action: 'Yeni bir "Lüks Villa" ilanı ekledi.', time: '2s önce', avatar: 'https://i.pravatar.cc/150?img=5' },
                    { id: 2, user: 'Mehmet Demir', action: '"3+1 Daire" talebi için eşleşme buldu.', time: '4s önce', avatar: 'https://i.pravatar.cc/150?img=3' },
                    { id: 3, user: 'Can Yıldız', action: 'Portföy fiyatını güncelledi.', time: '1d önce', avatar: 'https://i.pravatar.cc/150?img=8' },
                    { id: 4, user: 'Zeynep Çelik', action: 'Yeni bir talep oluşturdu.', time: '2d önce', avatar: 'https://i.pravatar.cc/150?img=9' }
                ],

                // ACTIONS
                formatPrice(price) {
                    if (!price) return '0 TL';
                    return new Intl.NumberFormat('tr-TR').format(price) + ' TL';
                },
                formatFullPrice(price) {
                    if (!price) return '0 TL';
                    return new Intl.NumberFormat('tr-TR').format(price) + ' TL';
                },
                deletePortfolio(id) {
                    if (confirm('Bu portföyü silmek istediğinize emin misiniz?')) {
                        this.portfolios = this.portfolios.filter(p => p.id !== id);
                        alert('Portföy silindi.');
                    }
                },
                editPortfolio(id) {
                    alert('Portföy düzenleme ekranı açılıyor... (ID: ' + id + ')');
                },
                approveMatch(id) {
                    alert('Eşleşme onaylandı! (ID: ' + id + ')');
                },
                rejectMatch(id) {
                    if (confirm('Bu eşleşmeyi reddetmek istiyor musunuz?')) {
                        this.matches = this.matches.filter(m => m.id !== id);
                    }
                },
                toggleFavorite(id) {
                    const match = this.matches.find(m => m.id === id);
                    if (match) {
                        match.isFavorite = !match.isFavorite;
                    }
                },
                sendMessage(name) {
                    alert(name + ' kişisine mesaj gönderiliyor...');
                },
                viewAll(section) {
                    alert(section + ' tümü görüntüleniyor...');
                },
            }
        }

        // Unregister Service Worker to fix caching issues
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function (registrations) {
                for (let registration of registrations) {
                    registration.unregister();
                    console.log('Service Worker unregistered');
                }
            });
        }
    </script>
    <!-- ADD PORTFOLIO MODAL (Popup) -->
    <div x-show="showAddModal" x-cloak class="fixed inset-0 z-[9999] overflow-y-auto"
        x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-150"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">

        <!-- Dark Overlay -->
        <div class="fixed inset-0 bg-black/50 transition-opacity" @click="showAddModal = false"></div>

        <!-- Modal Container -->
        <div class="flex min-h-full items-center justify-center p-4">
            <div class="relative bg-white rounded-2xl shadow-xl w-full max-w-lg transform transition-all" @click.stop>

                <!-- Modal Header -->
                <div class="flex items-center justify-between px-6 py-4 border-b border-gray-100">
                    <h2 class="text-xl font-bold text-gray-900">Yeni Portföy Ekle</h2>
                    <button @click="showAddModal = false" class="text-gray-400 hover:text-gray-600 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Body (Form) -->
                <div class="px-6 py-4 max-h-[70vh] overflow-y-auto">
                    <!-- Form Fields -->
                    <div class="space-y-4">
                        <!-- Fotoğraf Yükleme -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-1">Portföy Fotoğrafı</label>
                            <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg hover:border-blue-500 transition-colors cursor-pointer relative"
                                @click="$refs.fileInput.click()">
                                <div class="space-y-1 text-center">
                                    <template x-if="!newListingImages.length">
                                        <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none"
                                            viewBox="0 0 48 48" aria-hidden="true">
                                            <path
                                                d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02"
                                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                        </svg>
                                    </template>
                                    <template x-if="newListingImages.length">
                                        <img :src="newListingImages[0]" class="mx-auto h-32 object-cover rounded-lg">
                                    </template>
                                    <div class="flex text-sm text-gray-600 justify-center">
                                        <label
                                            class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500">
                                            <span>Fotoğraf Yükle</span>
                                            <input x-ref="fileInput" type="file" class="sr-only" accept="image/*"
                                                @change="handleImageUpload">
                                        </label>
                                    </div>
                                    <p class="text-xs text-gray-500">PNG, JPG, GIF (max 2MB)</p>
                                </div>
                            </div>
                        </div>

                        <!-- Başlık -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-1">Başlık</label>
                            <input type="text" x-model="newPortfolio.title"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="Örn: Deniz Manzaralı 3+1">
                        </div>

                        <!-- Tip & Kategori -->
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">Tip</label>
                                <select x-model="newPortfolio.type"
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="Satılık">Satılık</option>
                                    <option value="Kiralık">Kiralık</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">Kategori</label>
                                <select x-model="newPortfolio.category"
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="">Seçiniz</option>
                                    <option value="Villa">Villa</option>
                                    <option value="Daire">Daire</option>
                                    <option value="Arsa">Arsa</option>
                                    <option value="İşyeri">İşyeri</option>
                                </select>
                            </div>
                        </div>

                        <!-- Fiyat -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-1">Fiyat (TL)</label>
                            <input type="number" x-model="newPortfolio.price"
                                class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="Fiyat giriniz">
                        </div>

                        <!-- Şehir, İlçe, Semt -->
                        <div class="grid grid-cols-3 gap-3">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">Şehir</label>
                                <input type="text" x-model="newPortfolio.city"
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="İstanbul">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">İlçe</label>
                                <input type="text" x-model="newPortfolio.location"
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="Kadıköy">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">Semt</label>
                                <input type="text" x-model="newPortfolio.district"
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="Moda">
                            </div>
                        </div>

                        <!-- Oda, m², Yaş -->
                        <div class="grid grid-cols-3 gap-3">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">Oda</label>
                                <input type="text" x-model="newPortfolio.rooms"
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="3+1">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">m²</label>
                                <input type="text" x-model="newPortfolio.area"
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="120">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-1">Yaş</label>
                                <input type="text" x-model="newPortfolio.age"
                                    class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="5">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div class="flex gap-3 px-6 py-4 border-t border-gray-100 bg-gray-50 rounded-b-2xl">
                    <button @click="showAddModal = false"
                        class="flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors font-medium">
                        İptal
                    </button>
                    <button @click="saveNewPortfolio()"
                        class="flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium">
                        Kaydet
                    </button>
                </div>
            </div>
        </div>
    </div>
</body>

</html>